<?phpif ( ! defined( 'ABSPATH' ) ) {	exit; // Exit if accessed directly}class POD_Twilio_Settings extends POD_Twilio_Admin {		/**	*	@array	*	@private	*	saves saved settings	**/	private $_twilio_settings;		/**	*	@array	*	@private	*	setting tabs /  sections	**/	private $_tabs;		/**	*	current tab	*	@private	*	@var string	**/	private $_current_tab;		/**	* 	constructor of this class	*	sets tabs array and current tab	*/    public function __construct() {				/* load setting sections */		$this->_tabs = $this->_tabs();		$this->_current_tab = $this->_current_tab();				$this->_register_settings();				$this->_twilio_settings = get_option( "pod_twilio_". $this->_current_tab );	   	      }		/*	*	@private	*	register settings for each section	*/	private function _register_settings(){		foreach( $this->_tabs as $tab ){			register_setting( "pod_twilio_" . $tab['slug'], "pod_twilio_" . $tab['slug'] );		}	}		/**	*	get current tab	*	@return string		**/	private function _current_tab(){		if( ! isset( $_GET['tab'] ) || empty( $_GET['tab'] ) ){			$current_tab = "master_ac_settings";		}		else{			$current_tab = trim( $_GET['tab'] );		}		return $current_tab;	}		/*	*	@private	*	returns setting tabs array	*	@return array	*/	private function _tabs(){		$tabs = array(			"twilio_settings" => array(				"title" 	=> esc_html__( "Twilio Settings", POD_TWILIO_TEXT_DOMAIN ),				"slug" 		=> "master_ac_settings",				"callback" 	=> array( $this, "_master_account_setting" )			),			"payment_setings" => array(				"title" 	=> esc_html__( "Payment Settings", POD_TWILIO_TEXT_DOMAIN ),				"slug" 		=> "payment_settings",				"callback" 	=> array( $this, "_payment_setting" )			)		);		return apply_filters( "pod_twilio_admin_settings_tabs", array_merge( array(), $tabs ), $tabs );	}		/**	*	@public	*	load settings tabs add fields		**/	public function load_settings_view(){?>				<div class="wrap">			<h1><?php esc_html_e( "Settings", POD_TWILIO_TEXT_DOMAIN ); ?></h1>			<!-- load tabs -->			<h2 class="nav-tab-wrapper">			<?php				foreach($this->_tabs as $tab){						$active = ( $tab['slug'] == $this->_current_tab ) ? "nav-tab-active":"";					echo "<a href=\"?page=pod_twilio_settings&tab=".$tab["slug"]."\" class=\"nav-tab ".$active."\">".__( $tab['title'], POD_TWILIO_TEXT_DOMAIN )."</a>";				}							?>			</h2>			<!-- end tabs -->						<!-- tab section -->		<?php $this->_load_setting_section(); ?>			<!-- end tab section -->		</div><?php	}		private function _load_setting_section(){		/* rearrange tabs array in format array("slug"=>"callback") */		$callbacks = array_column( $this->_tabs, "callback", 'slug' );					/* load content according to current tab using callback function */		call_user_func( $callbacks[$this->_current_tab], $this->_current_tab );			}		/**	*	load twilio master account setting	*/    private function _master_account_setting( $tab_slug ) {        ?>        <div class="wrap">            <p class="about-description"><?php esc_html_e( "These details are available in your", POD_TWILIO_TEXT_DOMAIN ); ?> <a href="https://www.twilio.com/user/account" target="_blank"><?php esc_html_e( "Twilio dashboard", POD_TWILIO_TEXT_DOMAIN ); ?></a> <?php esc_html_e( "after", POD_TWILIO_TEXT_DOMAIN ); ?> <a href="https://www.twilio.com/try-twilio" target="_blank"><?php esc_html_e("signup", POD_TWILIO_TEXT_DOMAIN); ?></a>.</p>            <form method="post" action="options.php"> 				<?php settings_fields( "pod_twilio_". $tab_slug ); ?>                <?php do_settings_sections( "pod_twilio_". $tab_slug ); ?>				<?php wp_referer_field( true ) ?>                <table class="form-table">                    <tr valign="top">                        <th scope="row">                            <label for=""><?php esc_html_e( "Master Account SID", POD_TWILIO_TEXT_DOMAIN ); ?></label>                        </th>                        <td>                            <input name="<?php echo "pod_twilio_". $tab_slug; ?>[master_twilio_account_sid]" type="text" value="<?php echo $this->_twilio_settings['master_twilio_account_sid']; ?>" class="regular-text">                        </td>                    </tr>                    <tr valign="top">                        <th scope="row"><label for=""><?php esc_html_e( "Master Account Auth Token",  POD_TWILIO_TEXT_DOMAIN ); ?></label></th>                        <td>                            <input name="<?php echo "pod_twilio_". $tab_slug; ?>[master_twilio_account_auth_token]" type="text" value="<?php echo $this->_twilio_settings['master_twilio_account_auth_token']; ?>" class="regular-text">                        </td>                    </tr>                    <tr valign="top">					                        <th scope="row"><label for=""><?php esc_html_e( "Call Price (Per Minute)",  POD_TWILIO_TEXT_DOMAIN ); ?></label></th>		                        <td>							                            <input name="<?php echo "pod_twilio_". $tab_slug; ?>[call_cost_per_minute]" type="text" value="<?php echo $this->_twilio_settings['call_cost_per_minute']; ?>" class="regular-text">                        </td>					                    </tr>                </table>                <?php submit_button(); ?>            </form>        </div>        <?php    }		private function _payment_setting( $tab_slug ){	//	$payment_settings = get_option( "pod_twilio_payment_options" );	?>		<div class="wrap">			<form method="post" action="options.php">				<?php settings_fields( "pod_twilio_". $tab_slug ); ?>                <?php do_settings_sections( "pod_twilio_". $tab_slug ); ?>				<?php wp_referer_field( true ) ?>				<table class="form-table">					 <tr valign="top">						 <th scope="row">							 <label for=""><?php esc_html_e( "Paypal Email", POD_TWILIO_TEXT_DOMAIN ); ?></label>						 </th>						  <td>                            <input name="<?php echo "pod_twilio_". $tab_slug; ?>[paypal_email_address]" type="text" value="<?php echo $this->_twilio_settings["paypal_email_address"]; ?>" class="regular-text" placeholder="">                            <p class="description"><?php esc_html_e( "Emai Address of your Paypal Business Account", POD_TWILIO_TEXT_DOMAIN ); ?></p>                        </td>					 </tr>					 <tr>						<th scope="row"><?php esc_html_e( "Enable Sandbox", POD_TWILIO_TEXT_DOMAIN ); ?></th>						<td> 							<fieldset>								<legend class="screen-reader-text">									<span><?php esc_html_e( "Enable Sandbox", POD_TWILIO_TEXT_DOMAIN ); ?></span>								</legend>								<label for="paypal_sanbox_mode">									<input name="<?php echo "pod_twilio_". $tab_slug; ?>[paypal_sanbox_mode]" id="paypal_sanbox_mode" value="1" type="checkbox" <?php echo isset( $this->_twilio_settings["paypal_sanbox_mode"] ) ? "checked=\"checked\"":""; ?>><?php esc_html_e( "Enable Paypal Sandbox Mode for Testing", POD_TWILIO_TEXT_DOMAIN ); ?>								</label>							</fieldset>						</td>					</tr>					<tr valign="top">						<th scope="row">							 <label for=""><?php esc_html_e("Currency Code", POD_TWILIO_TEXT_DOMAIN); ?></label>						 </th>						  <td>                            <input name="<?php echo "pod_twilio_". $tab_slug; ?>[paypal_currency_code]" type="text" value="<?php echo $this->_twilio_settings["paypal_currency_code"]; ?>" class="regular-text" placeholder="">                            <p class="description"><?php esc_html_e("Currency Code e.g. USD", POD_TWILIO_TEXT_DOMAIN); ?></p>                        </td>					</tr>					<tr valign="top">						<th scope="row">							 <label for=""><?php esc_html_e( "Currency Symbol", POD_TWILIO_TEXT_DOMAIN ); ?></label>						 </th>						  <td>                            <input name="<?php echo "pod_twilio_". $tab_slug; ?>[paypal_currency_symbol]" type="text" value="<?php echo $this->_twilio_settings["paypal_currency_symbol"]; ?>" class="regular-text" placeholder="">                            <p class="description"><?php esc_html_e( "Currency Symbol e.g. '$' for USD", POD_TWILIO_TEXT_DOMAIN ); ?></p>                        </td>					 </tr>				</table>				<?php submit_button(); ?>			</form>		</div><?php	}}